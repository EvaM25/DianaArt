"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,n){if(e){if("string"==typeof e)return _arrayLikeToArray(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,n):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}!function(e,n){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?n(require("imask"),require("just-validate")):"function"==typeof define&&define.amd?define("index",["imask","just-validate"],n):n((e=e||self).Inputmask,e.JustValidate)}(void 0,(function(e,n){e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n;var t=document.getElementById("header");window.addEventListener("scroll",(function(){window.scrollY>90?t.classList.add("header__scroll"):t.classList.remove("header__scroll")}));var r=new IntersectionObserver((function(e){console.log(e),e.forEach((function(e){e.isIntersecting&&document.querySelectorAll(".nav__link").forEach((function(n){n.getAttribute("href").replace("#","")===e.target.id?n.classList.add("nav__link-active"):n.classList.remove("nav__link-active")}))}))}),{threshold:.5});document.querySelectorAll(".section").forEach((function(e){r.observe(e)})),document.querySelectorAll(".nav__link").forEach((function(e){e.addEventListener("click",(function(n){n.preventDefault();var t=e.getAttribute("href").substr(1),r=document.getElementById(t).offsetTop;document.querySelector(".header").classList.remove("open"),window.scrollTo({top:r,behavior:"smooth"})}))}));document.addEventListener("DOMContentLoaded",(function(){document.getElementById("burger").addEventListener("click",(function(){document.querySelector("header").classList.toggle("open")}))}));document.getElementById("nav").addEventListener("click",(function(e){e._isClickWithInMenu=!0})),document.getElementById("burger").addEventListener("click",(function(e){e._isClickWithInMenu=!0})),document.querySelector(".nav__link").addEventListener("click",(function(e){e._isClickWithInMenu||document.querySelector(".header").classList.remove("open")}));new Swiper(".swiper",{slidesPerView:1,loop:!0,centerSlide:!0,fade:!0,grabCursor:!0,pagination:{el:".swiper-pagination",clickable:!0,dynamicBullets:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{0:{slidesPerView:1},1024:{slidesPerView:1},1250:{slidesPerView:1}}});$(document).ready((function(){$("#open-gallery-classic").on("click",(function(){$(".gallery__link-classic").magnificPopup({type:"image",gallery:{enabled:!0}}).magnificPopup("open")}))})),$(document).ready((function(){$("#open-gallery-portrait").on("click",(function(){$(".gallery__link-portrait").magnificPopup({type:"image",gallery:{enabled:!0}}).magnificPopup("open")}))})),$(document).ready((function(){$("#open-gallery-fashion").on("click",(function(){$(".gallery__link-fashion").magnificPopup({type:"image",gallery:{enabled:!0}}).magnificPopup("open")}))})),$(document).ready((function(){$("#open-gallery-anime").on("click",(function(){$(".gallery__link-anime").magnificPopup({type:"image",gallery:{enabled:!0}}).magnificPopup("open")}))})),$(document).ready((function(){$("#open-gallery-bw").on("click",(function(){$(".gallery__link-bw").magnificPopup({type:"image",gallery:{enabled:!0}}).magnificPopup("open")}))})),$(document).ready((function(){$("#open-gallery-chloe").on("click",(function(){$(".gallery__link-chloe").magnificPopup({type:"image",gallery:{enabled:!0}}).magnificPopup("open")}))})),$(document).ready((function(){$("#open-gallery-estee").on("click",(function(){$(".gallery__link-estee").magnificPopup({type:"image",gallery:{enabled:!0}}).magnificPopup("open")}))})),$(document).ready((function(){$("#open-gallery-omega").on("click",(function(){$(".gallery__link-omega").magnificPopup({type:"image",gallery:{enabled:!0}}).magnificPopup("open")}))})),$(document).ready((function(){$("#open-gallery-nashi").on("click",(function(){$(".gallery__link-nashi").magnificPopup({type:"image",gallery:{enabled:!0}}).magnificPopup("open")}))})),$(document).ready((function(){$("#open-gallery-illustrations").on("click",(function(){$(".gallery__link-illustrations").magnificPopup({type:"image",gallery:{enabled:!0}}).magnificPopup("open")}))}));var o=document.querySelector("#phone");new e("+7(999)999-99-99").mask(o),new n("#form").addField("#name",[{rule:"required",errorMessage:"Enter your name"},{rule:"minLength",value:2,errorMessage:"Please enter your name with at least 2 characters"},{rule:"customRegexp",value:/^[a-zA-Zа-яА-Я\s]+$/,errorMessage:"Only letters and spaces are allowed in the name"}]).addField("#email",[{rule:"required",errorMessage:"Enter your email adress"},{rule:"email",errorMessage:"Please enter a valid email address "}]).addField("#phone",[{validator:function(e){var n=o.inputmask.unmaskedvalue();return Boolean(Number(n)&&n.length>0)},errorMessage:"Enter your phone number"},{validator:function(e){var n=o.inputmask.unmaskedvalue();return Boolean(Number(n)&&10===n.length)},errorMessage:"Enter a valid phone number"}]).addField("#message",[{rule:"required",errorMessage:"Enter your message"},{rule:"minLength",value:10,errorMessage:"Please enter a message with at least 10 characters"},{rule:"maxLength",value:150,errorMessage:"Message must be 150 characters or less"}]).addField("#checkbox",[{rule:"required",errorMessage:" Please agree to our data processing policy"}]).onSuccess((function(e){var n;console.log("Validation passes and form submitted",e),console.log("Validation passes and form submitted",e);var t=new FormData(e.target);(n=console).log.apply(n,_toConsumableArray(t));var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&200===r.status&&(console.log("Отправлено"),document.getElementById("modal").classList.add("open"))},r.open("POST","mail.php",!0),r.send(t),e.target.reset()})),document.getElementById("close-modal").addEventListener("click",(function(){document.getElementById("modal").classList.remove("open")})),window.addEventListener("keydown",(function(e){"Escape"===e.key&&document.getElementById("modal").classList.remove("open")})),document.querySelector("#modal .modal__box").addEventListener("click",(function(e){e._isCklickWithinModal=!0})),document.getElementById("modal").addEventListener("click",(function(e){e._isCklickWithinModal||e.currentTarget.classList.remove("open")}))}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImdsb2JhbCIsImZhY3RvcnkiLCJleHBvcnRzIiwiX3R5cGVvZiIsIm1vZHVsZSIsInJlcXVpcmUiLCJkZWZpbmUiLCJhbWQiLCJzZWxmIiwiSW5wdXRtYXNrIiwiSnVzdFZhbGlkYXRlIiwiT2JqZWN0IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaGVhZGVySlMiLCJnZXRFbGVtZW50QnlJZCIsIndpbmRvdyIsInNjcm9sbFkiLCJkb2N1bWVudCIsImNsYXNzTGlzdCIsIkludGVyc2VjdGlvbk9ic2VydmVyIiwiZW50cmllcyIsImNvbnNvbGUiLCJsb2ciLCJmb3JFYWNoIiwiZW50cnkiLCJpc0ludGVyc2VjdGluZyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJsaW5rIiwicmVwbGFjZSIsInRhcmdldCIsImlkIiwiYWRkIiwidGhyZXNob2xkIiwic2VjdGlvbiIsIm9ic2VydmVyIiwib2JzZXJ2ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInRhcmdldElkIiwiZ2V0QXR0cmlidXRlIiwic3Vic3RyIiwib2Zmc2V0VG9wIiwicXVlcnlTZWxlY3RvciIsInJlbW92ZSIsInNjcm9sbFBvcyIsInRhcmdldEVsZW1lbnQiLCJ0b3AiLCJzY3JvbGxUbyIsIm1lbnVCdXJnZXIiLCJ0b2dnbGUiLCJfaXNDbGlja1dpdGhJbk1lbnUiLCJzd2lwZXIiLCJsb29wIiwiU3dpcGVyIiwiZ3JhYkN1cnNvciIsInBhZ2luYXRpb24iLCJlbCIsImNsaWNrYWJsZSIsImR5bmFtaWNCdWxsZXRzIiwibmF2aWdhdGlvbiIsIm5leHRFbCIsInByZXZFbCIsImJyZWFrcG9pbnRzIiwic2xpZGVzUGVyVmlldyIsIiQiLCJlbmFibGVkIiwib24iLCJtYWduaWZpY1BvcHVwIiwidHlwZSIsImdhbGxlcnkiLCJyZWFkeSIsIm1hc2siLCJzZWxlY3RvciIsInZhbGlkYXRpb24iLCJlcnJvck1lc3NhZ2UiLCJ2YWx1ZSIsImFkZEZpZWxkIiwidmFsaWRhdG9yIiwicnVsZSIsIkJvb2xlYW4iLCJpbnB1dG1hc2siLCJ1bm1hc2tlZHZhbHVlIiwib25TdWNjZXNzIiwiTnVtYmVyIiwidGVsIiwibGVuZ3RoIiwiX2NvbnNvbGUiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInNob3dNb2RhbCIsInJlc2V0IiwiX2lzQ2tsaWNrV2l0aGluTW9kYWwiLCJjdXJyZW50VGFyZ2V0IiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsImFwcGx5IiwiX3RvQ29uc3VtYWJsZUFycmF5IiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsIm9wZW4iLCJzZW5kIiwiZSIsImtleSJdLCJtYXBwaW5ncyI6Inl1Q0FBQyxTQUFVQSxFQUFRQyxHQUNHLFlBQUwsb0JBQVBDLFFBQU8sWUFBQUMsUUFBUEQsV0FBMEMsb0JBQVhFLE9BQXlCSCxFQUFRSSxRQUFRLFNBQVVBLFFBQVEsa0JBQy9FLG1CQUFYQyxRQUF5QkEsT0FBT0MsSUFBTUQsT0FBTyxRQUFTLENBQUMsUUFBUyxpQkFBa0JMLEdBQy9EQSxHQUF6QkQsRUFBU0EsR0FBVVEsTUFBcUJDLFVBQVdULEVBQU9VLGFBQzdELENBSkEsTUFJQSxHQUFRLFNBQVVELEVBQVdDLEdBRTNCRCxFQUFZQSxHQUFhRSxPQUFPQyxVQUFVQyxlQUFlQyxLQUFLTCxFQUFXLFdBQWFBLEVBQW1CLFFBQUlBLEVBQzdHQyxFQUFlQSxHQUFnQkMsT0FBT0MsVUFBVUMsZUFBZUMsS0FBS0osRUFBYyxXQUFhQSxFQUFzQixRQUFJQSxFQVAzSCxJQUFBSyxFQUFrQmQsU0FBU2UsZUFBQSxVQUN6QkMsT0FBT2YsaUJBQU8sVUFBQSxXQUdFTyxPQUFTUyxRQVNQLEdBUFRILEVBQUdOLFVBQWFFLElBQU9DLGtCQUcxQkcsRUFBV0ksVUFBU0gsT0FBQUEsaUJBUzFCLElBRUEsSUFOUUQsRUFBU0ssSUFBU0Msc0JBQXFCLFNBQUNDLEdBQzFDQyxRQUFLQyxJQUFBRixHQUNMUCxFQUFRVSxTQUFDTCxTQUFBQSxH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QVV5QixPQUFPLE9BQ3BELElBRUE1QixPQUFPcUIsaUJBQWlCLFdBQVcsU0FBQ2tFLEdBQ3JCLFdBQVZBLEVBQUVDLEtBQ0R0RixTQUFTSCxlQUFlLFNBQVNJLFVBQVV5QixPQUFPLE9BRXhELElBRUExQixTQUFTeUIsY0FBYyxzQkFBc0JOLGlCQUFpQixTQUFTLFNBQUNrRSxHQUN0RUEsRUFBRVYsc0JBQXVCLENBQzNCLElBRUEzRSxTQUFTSCxlQUFlLFNBQVNzQixpQkFBaUIsU0FBUyxTQUFDa0UsR0FDdkRBLEVBQUVWLHNCQUNMVSxFQUFFVCxjQUFjM0UsVUFBVXlCLE9BQU8sT0FDbkMsR0FFVCIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XG4gICB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBmYWN0b3J5KHJlcXVpcmUoJ2ltYXNrJyksIHJlcXVpcmUoJ2p1c3QtdmFsaWRhdGUnKSkgOlxuICAgdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKCdpbmRleCcsIFsnaW1hc2snLCAnanVzdC12YWxpZGF0ZSddLCBmYWN0b3J5KSA6XG4gICAoZ2xvYmFsID0gZ2xvYmFsIHx8IHNlbGYsIGZhY3RvcnkoZ2xvYmFsLklucHV0bWFzaywgZ2xvYmFsLkp1c3RWYWxpZGF0ZSkpO1xufSh0aGlzLCAoZnVuY3Rpb24gKElucHV0bWFzaywgSnVzdFZhbGlkYXRlKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgSW5wdXRtYXNrID0gSW5wdXRtYXNrICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChJbnB1dG1hc2ssICdkZWZhdWx0JykgPyBJbnB1dG1hc2tbJ2RlZmF1bHQnXSA6IElucHV0bWFzaztcbiAgIEp1c3RWYWxpZGF0ZSA9IEp1c3RWYWxpZGF0ZSAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoSnVzdFZhbGlkYXRlLCAnZGVmYXVsdCcpID8gSnVzdFZhbGlkYXRlWydkZWZhdWx0J10gOiBKdXN0VmFsaWRhdGU7XG5cbiAgIGNvbnN0IGhlYWRlckpTID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJoZWFkZXJcIik7XHJcbiAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsID0gd2luZG93LnNjcm9sbFk7XHJcblxyXG4gICAgICAgIGlmIChzY3JvbGwgPiA5MCl7XHJcbiAgICAgICAgICAgaGVhZGVySlMuY2xhc3NMaXN0LmFkZCgnaGVhZGVyX19zY3JvbGwnKTtcclxuICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgIGhlYWRlckpTLmNsYXNzTGlzdC5yZW1vdmUoJ2hlYWRlcl9fc2Nyb2xsJyk7XHJcbiAgICAgICAgfVxyXG4gICB9KTtcclxuXHJcbiAgIGNvbnN0IG9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChlbnRyaWVzKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVudHJpZXMpO1xyXG4gICAgICBlbnRyaWVzLmZvckVhY2goKGVudHJ5KSA9PiB7XHJcbiAgICAgICAgaWYgKGVudHJ5LmlzSW50ZXJzZWN0aW5nKSB7XHJcbiAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubmF2X19saW5rJykuZm9yRWFjaCgobGluaykgPT4ge1xyXG4gICAgICAgICAgICBsZXQgaWQgPSBsaW5rLmdldEF0dHJpYnV0ZSgnaHJlZicpLnJlcGxhY2UoJyMnLCAnJyk7XHJcbiAgICAgICAgICAgIGlmIChpZCA9PT0gZW50cnkudGFyZ2V0LmlkKSB7XHJcbiAgICAgICAgICAgICAgbGluay5jbGFzc0xpc3QuYWRkKCduYXZfX2xpbmstYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgbGluay5jbGFzc0xpc3QucmVtb3ZlKCduYXZfX2xpbmstYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9LCB7XHJcbiAgICAgIHRocmVzaG9sZDogMC41XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlY3Rpb24nKS5mb3JFYWNoKHNlY3Rpb24gPT4geyBvYnNlcnZlci5vYnNlcnZlKHNlY3Rpb24pO30gKTtcclxuXHJcbiAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5uYXZfX2xpbmsnKS5mb3JFYWNoKGxpbmsgPT4ge1xyXG4gICAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBldmVudCA9PiB7XHJcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBjb25zdCB0YXJnZXRJZCA9IGxpbmsuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKS5zdWJzdHIoMSk7XHJcbiAgICAgICAgICBjb25zdCB0YXJnZXRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgY29uc3Qgc2Nyb2xsUG9zID0gdGFyZ2V0RWxlbWVudC5vZmZzZXRUb3A7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyXCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oe1xyXG4gICAgICAgICAgICAgIHRvcDogc2Nyb2xsUG9zLFxyXG4gICAgICAgICAgICAgIGJlaGF2aW9yOiBcInNtb290aFwiXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgIH0pO1xuXG4gICBjb25zdCBtZW51QnVyZ2VyID0gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidXJnZXJcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaGVhZGVyXCIpLmNsYXNzTGlzdC50b2dnbGUoXCJvcGVuXCIpO1xyXG4gICAgICAgfSk7XHJcbiAgICAgfSk7XHJcbiAgICAgXHJcbiAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYXZcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGV2ZW50ID0+IHtcclxuICAgICAgIGV2ZW50Ll9pc0NsaWNrV2l0aEluTWVudSA9IHRydWU7XHJcbiAgICAgfSk7XHJcbiAgICAgXHJcbiAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidXJnZXJcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGV2ZW50ID0+IHtcclxuICAgICAgIGV2ZW50Ll9pc0NsaWNrV2l0aEluTWVudSA9IHRydWU7XHJcbiAgICAgfSk7XHJcbiAgICAgXHJcbiAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uYXZfX2xpbmsnKTtcclxuICAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBldmVudCA9PiB7XHJcbiAgICAgICBpZiAoZXZlbnQuX2lzQ2xpY2tXaXRoSW5NZW51KSByZXR1cm47XHJcbiAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYWRlclwiKS5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcclxuICAgICAgIFxyXG4gICAgIH0pO1xuXG4gICBjb25zdCBzd2lwZXIgPSBuZXcgU3dpcGVyKFwiLnN3aXBlclwiLCB7XHJcbiAgICAgICBzbGlkZXNQZXJWaWV3OiAxLFxyXG4gICAgICAgbG9vcDogdHJ1ZSxcclxuICAgICAgIGNlbnRlclNsaWRlOiB0cnVlLFxyXG4gICAgICAgZmFkZTogdHJ1ZSxcclxuICAgICAgIGdyYWJDdXJzb3I6IHRydWUsXHJcbiAgICAgICBwYWdpbmF0aW9uOiB7XHJcbiAgICAgICAgIGVsOiBcIi5zd2lwZXItcGFnaW5hdGlvblwiLFxyXG4gICAgICAgICBjbGlja2FibGU6IHRydWUsXHJcbiAgICAgICAgIGR5bmFtaWNCdWxsZXRzOiB0cnVlLFxyXG4gICAgICAgfSxcclxuICAgICAgIG5hdmlnYXRpb246IHtcclxuICAgICAgICAgICBuZXh0RWw6IFwiLnN3aXBlci1idXR0b24tbmV4dFwiLFxyXG4gICAgICAgICAgIHByZXZFbDogXCIuc3dpcGVyLWJ1dHRvbi1wcmV2XCJcclxuICAgICAgIH0sXHJcbiAgICAgXHJcbiAgICAgICBicmVha3BvaW50czoge1xyXG4gICAgICAgICAgIDA6IHtcclxuICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDEsXHJcbiAgICAgICAgICAgfSxcclxuICAgICAgICAgICAxMDI0OiB7XHJcbiAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAxLFxyXG4gICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgMTI1MDoge1xyXG4gICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMSxcclxuICAgICAgICAgICB9ICAgICBcclxuICAgICAgIH0sXHJcbiAgICAgfSk7XG5cbiAgIC8vc3R5bGVzXHJcblxyXG4gICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcclxuICAgICAgICQoJyNvcGVuLWdhbGxlcnktY2xhc3NpYycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAkKCcuZ2FsbGVyeV9fbGluay1jbGFzc2ljJykubWFnbmlmaWNQb3B1cCh7XHJcbiAgICAgICAgICAgdHlwZTogJ2ltYWdlJyxcclxuICAgICAgICAgICBnYWxsZXJ5OntcclxuICAgICAgICAgICAgIGVuYWJsZWQ6dHJ1ZVxyXG4gICAgICAgICAgIH1cclxuICAgICAgICAgfSkubWFnbmlmaWNQb3B1cCgnb3BlbicpO1xyXG4gICAgICAgfSk7XHJcbiAgICAgfSk7XHJcblxyXG4gICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgJCgnI29wZW4tZ2FsbGVyeS1wb3J0cmFpdCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAkKCcuZ2FsbGVyeV9fbGluay1wb3J0cmFpdCcpLm1hZ25pZmljUG9wdXAoe1xyXG4gICAgICAgICAgIHR5cGU6ICdpbWFnZScsXHJcbiAgICAgICAgICAgZ2FsbGVyeTp7XHJcbiAgICAgICAgICAgICBlbmFibGVkOnRydWVcclxuICAgICAgICAgICB9XHJcbiAgICAgICAgIH0pLm1hZ25pZmljUG9wdXAoJ29wZW4nKTtcclxuICAgICAgIH0pO1xyXG4gICAgIH0pO1xyXG5cclxuICAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcclxuICAgICAgICQoJyNvcGVuLWdhbGxlcnktZmFzaGlvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAkKCcuZ2FsbGVyeV9fbGluay1mYXNoaW9uJykubWFnbmlmaWNQb3B1cCh7XHJcbiAgICAgICAgICAgdHlwZTogJ2ltYWdlJyxcclxuICAgICAgICAgICBnYWxsZXJ5OntcclxuICAgICAgICAgICAgIGVuYWJsZWQ6dHJ1ZVxyXG4gICAgICAgICAgIH1cclxuICAgICAgICAgfSkubWFnbmlmaWNQb3B1cCgnb3BlbicpO1xyXG4gICAgICAgfSk7XHJcbiAgICAgfSk7XHJcblxyXG4gICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgJCgnI29wZW4tZ2FsbGVyeS1hbmltZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAkKCcuZ2FsbGVyeV9fbGluay1hbmltZScpLm1hZ25pZmljUG9wdXAoe1xyXG4gICAgICAgICAgIHR5cGU6ICdpbWFnZScsXHJcbiAgICAgICAgICAgZ2FsbGVyeTp7XHJcbiAgICAgICAgICAgICBlbmFibGVkOnRydWVcclxuICAgICAgICAgICB9XHJcbiAgICAgICAgIH0pLm1hZ25pZmljUG9wdXAoJ29wZW4nKTtcclxuICAgICAgIH0pO1xyXG4gICAgIH0pO1xyXG5cclxuICAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcclxuICAgICAgICQoJyNvcGVuLWdhbGxlcnktYncnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgJCgnLmdhbGxlcnlfX2xpbmstYncnKS5tYWduaWZpY1BvcHVwKHtcclxuICAgICAgICAgICB0eXBlOiAnaW1hZ2UnLFxyXG4gICAgICAgICAgIGdhbGxlcnk6e1xyXG4gICAgICAgICAgICAgZW5hYmxlZDp0cnVlXHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgICB9KS5tYWduaWZpY1BvcHVwKCdvcGVuJyk7XHJcbiAgICAgICB9KTtcclxuICAgICB9KTtcclxuXHJcbiAgICAgIC8vZXhwZXJpZW5jZVxyXG5cclxuICAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcclxuICAgICAgICQoJyNvcGVuLWdhbGxlcnktY2hsb2UnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgJCgnLmdhbGxlcnlfX2xpbmstY2hsb2UnKS5tYWduaWZpY1BvcHVwKHtcclxuICAgICAgICAgICB0eXBlOiAnaW1hZ2UnLFxyXG4gICAgICAgICAgIGdhbGxlcnk6e1xyXG4gICAgICAgICAgICAgZW5hYmxlZDp0cnVlXHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgICB9KS5tYWduaWZpY1BvcHVwKCdvcGVuJyk7XHJcbiAgICAgICB9KTtcclxuICAgICB9KTtcclxuXHJcbiAgICAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAkKCcjb3Blbi1nYWxsZXJ5LWVzdGVlJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICQoJy5nYWxsZXJ5X19saW5rLWVzdGVlJykubWFnbmlmaWNQb3B1cCh7XHJcbiAgICAgICAgICAgdHlwZTogJ2ltYWdlJyxcclxuICAgICAgICAgICBnYWxsZXJ5OntcclxuICAgICAgICAgICAgIGVuYWJsZWQ6dHJ1ZVxyXG4gICAgICAgICAgIH1cclxuICAgICAgICAgfSkubWFnbmlmaWNQb3B1cCgnb3BlbicpO1xyXG4gICAgICAgfSk7XHJcbiAgICAgfSk7XHJcblxyXG4gICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgJCgnI29wZW4tZ2FsbGVyeS1vbWVnYScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAkKCcuZ2FsbGVyeV9fbGluay1vbWVnYScpLm1hZ25pZmljUG9wdXAoe1xyXG4gICAgICAgICAgIHR5cGU6ICdpbWFnZScsXHJcbiAgICAgICAgICAgZ2FsbGVyeTp7XHJcbiAgICAgICAgICAgICBlbmFibGVkOnRydWVcclxuICAgICAgICAgICB9XHJcbiAgICAgICAgIH0pLm1hZ25pZmljUG9wdXAoJ29wZW4nKTtcclxuICAgICAgIH0pO1xyXG4gICAgIH0pO1xyXG5cclxuICAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcclxuICAgICAgICQoJyNvcGVuLWdhbGxlcnktbmFzaGknKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgJCgnLmdhbGxlcnlfX2xpbmstbmFzaGknKS5tYWduaWZpY1BvcHVwKHtcclxuICAgICAgICAgICB0eXBlOiAnaW1hZ2UnLFxyXG4gICAgICAgICAgIGdhbGxlcnk6e1xyXG4gICAgICAgICAgICAgZW5hYmxlZDp0cnVlXHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgICB9KS5tYWduaWZpY1BvcHVwKCdvcGVuJyk7XHJcbiAgICAgICB9KTtcclxuICAgICB9KTtcclxuXHJcbiAgICAgLy9pbGx1c3RyYXRpb25zIFxyXG4gICAgIFxyXG4gICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgJCgnI29wZW4tZ2FsbGVyeS1pbGx1c3RyYXRpb25zJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICQoJy5nYWxsZXJ5X19saW5rLWlsbHVzdHJhdGlvbnMnKS5tYWduaWZpY1BvcHVwKHtcclxuICAgICAgICAgICB0eXBlOiAnaW1hZ2UnLFxyXG4gICAgICAgICAgIGdhbGxlcnk6e1xyXG4gICAgICAgICAgICAgZW5hYmxlZDp0cnVlXHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgICB9KS5tYWduaWZpY1BvcHVwKCdvcGVuJyk7XHJcbiAgICAgICB9KTtcclxuICAgICB9KTtcblxuICAgbGV0IHNlbGVjdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwaG9uZVwiKTtcclxuICAgbGV0IGltID0gbmV3IElucHV0bWFzayhcIis3KDk5OSk5OTktOTktOTlcIik7XHJcbiAgIGltLm1hc2soc2VsZWN0b3IpO1xyXG5cclxuICAgY29uc3QgdmFsaWRhdGlvbiA9IG5ldyBKdXN0VmFsaWRhdGUoJyNmb3JtJyk7XHJcblxyXG4gICB2YWxpZGF0aW9uLmFkZEZpZWxkKFwiI25hbWVcIiwgW1xyXG4gICAgICAge1xyXG4gICAgICAgICAgIHJ1bGU6IFwicmVxdWlyZWRcIiwgXHJcbiAgICAgICAgICAgZXJyb3JNZXNzYWdlOiBcIkVudGVyIHlvdXIgbmFtZVwiLCAgICBcclxuICAgICAgIH0sXHJcbiAgICAgICB7XHJcbiAgICAgICAgICAgcnVsZTogXCJtaW5MZW5ndGhcIiwgXHJcbiAgICAgICAgICAgdmFsdWU6IDIsXHJcbiAgICAgICAgICAgZXJyb3JNZXNzYWdlOiBcIlBsZWFzZSBlbnRlciB5b3VyIG5hbWUgd2l0aCBhdCBsZWFzdCAyIGNoYXJhY3RlcnNcIiAgXHJcbiAgICAgICB9LFxyXG4gICAgICAge1xyXG4gICAgICAgICAgIHJ1bGU6IFwiY3VzdG9tUmVnZXhwXCIsXHJcbiAgICAgICAgICAgdmFsdWU6IC9eW2EtekEtWtCwLdGP0JAt0K9cXHNdKyQvLFxyXG4gICAgICAgICAgIGVycm9yTWVzc2FnZTogXCJPbmx5IGxldHRlcnMgYW5kIHNwYWNlcyBhcmUgYWxsb3dlZCBpbiB0aGUgbmFtZVwiXHJcbiAgICAgICAgICAgfVxyXG4gICBdKS5hZGRGaWVsZChcIiNlbWFpbFwiLCBbXHJcbiAgICAgICB7XHJcbiAgICAgICAgICAgcnVsZTogXCJyZXF1aXJlZFwiLCBcclxuICAgICAgICAgICBlcnJvck1lc3NhZ2U6IFwiRW50ZXIgeW91ciBlbWFpbCBhZHJlc3NcIiAgXHJcbiAgICAgICB9LFxyXG4gICAgICAge1xyXG4gICAgICAgICAgIHJ1bGU6IFwiZW1haWxcIiwgXHJcbiAgICAgICAgICAgZXJyb3JNZXNzYWdlOiBcIlBsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsIGFkZHJlc3MgXCIgIFxyXG4gICAgICAgfVxyXG4gICBdKS5hZGRGaWVsZChcIiNwaG9uZVwiLCBbXHJcbiAgICAge1xyXG4gICAgICAgdmFsaWRhdG9yOiAodmFsdWUpID0+IHtcclxuICAgICAgICAgY29uc3QgdGVsID0gc2VsZWN0b3IuaW5wdXRtYXNrLnVubWFza2VkdmFsdWUoKTtcclxuICAgICAgICAgcmV0dXJuIEJvb2xlYW4oTnVtYmVyKHRlbCkgJiYgdGVsLmxlbmd0aCA+IDApXHJcbiAgICAgICB9LFxyXG4gICAgICAgZXJyb3JNZXNzYWdlOiBcIkVudGVyIHlvdXIgcGhvbmUgbnVtYmVyXCIgIFxyXG4gICAgIH0sXHJcbiAgICAge1xyXG4gICAgICAgdmFsaWRhdG9yOiAodmFsdWUpID0+IHtcclxuICAgICAgICAgY29uc3QgdGVsID0gc2VsZWN0b3IuaW5wdXRtYXNrLnVubWFza2VkdmFsdWUoKTtcclxuICAgICAgICAgcmV0dXJuIEJvb2xlYW4oTnVtYmVyKHRlbCkgJiYgdGVsLmxlbmd0aCA9PT0gMTApXHJcbiAgICAgICB9LCBcclxuICAgICAgICAgZXJyb3JNZXNzYWdlOiBcIkVudGVyIGEgdmFsaWQgcGhvbmUgbnVtYmVyXCIgIFxyXG4gICAgICAgfVxyXG4gICAgIF0pLmFkZEZpZWxkKFwiI21lc3NhZ2VcIiwgW1xyXG4gICAgICAge1xyXG4gICAgICAgICAgIHJ1bGU6IFwicmVxdWlyZWRcIiwgXHJcbiAgICAgICAgICAgZXJyb3JNZXNzYWdlOiBcIkVudGVyIHlvdXIgbWVzc2FnZVwiICBcclxuICAgICAgIH0sXHJcbiAgICAgICB7XHJcbiAgICAgICAgICAgcnVsZTogXCJtaW5MZW5ndGhcIiwgXHJcbiAgICAgICAgICAgdmFsdWU6IDEwLFxyXG4gICAgICAgICAgIGVycm9yTWVzc2FnZTogXCJQbGVhc2UgZW50ZXIgYSBtZXNzYWdlIHdpdGggYXQgbGVhc3QgMTAgY2hhcmFjdGVyc1wiICBcclxuICAgICAgIH0sXHJcbiAgICAgICB7XHJcbiAgICAgICAgICAgcnVsZTogXCJtYXhMZW5ndGhcIiwgXHJcbiAgICAgICAgICAgdmFsdWU6IDE1MCxcclxuICAgICAgICAgICBlcnJvck1lc3NhZ2U6IFwiTWVzc2FnZSBtdXN0IGJlIDE1MCBjaGFyYWN0ZXJzIG9yIGxlc3NcIiAgXHJcbiAgICAgICB9XHJcbiAgIF0pLmFkZEZpZWxkKFwiI2NoZWNrYm94XCIsW1xyXG4gICAgICAge1xyXG4gICAgICAgICAgIHJ1bGU6IFwicmVxdWlyZWRcIixcclxuICAgICAgICAgICBlcnJvck1lc3NhZ2U6IFwiIFBsZWFzZSBhZ3JlZSB0byBvdXIgZGF0YSBwcm9jZXNzaW5nIHBvbGljeVwiXHJcbiAgICAgICB9XHJcbiAgIF0pLm9uU3VjY2VzcygoZXZlbnQpID0+IHtcclxuXHJcbiAgICAgICAgICAgY29uc29sZS5sb2coJ1ZhbGlkYXRpb24gcGFzc2VzIGFuZCBmb3JtIHN1Ym1pdHRlZCcsIGV2ZW50KTtcclxuXHJcbiAgICAgICAgICAgY29uc29sZS5sb2coJ1ZhbGlkYXRpb24gcGFzc2VzIGFuZCBmb3JtIHN1Ym1pdHRlZCcsIGV2ZW50KTtcclxuICAgICAgIFxyXG4gICAgICAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShldmVudC50YXJnZXQpO1xyXG4gICAgICAgXHJcbiAgICAgICAgICAgY29uc29sZS5sb2coLi4uZm9ybURhdGEpO1xyXG4gICAgICAgXHJcbiAgICAgICAgICAgbGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgICAgXHJcbiAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gNCkge1xyXG4gICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ9Ce0YLQv9GA0LDQstC70LXQvdC+Jyk7XHJcbiAgICAgICAgICAgICAgICAgc2hvd01vZGFsKCk7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgIH1cclxuICAgICAgICAgICB9O1xyXG4gICAgICAgXHJcbiAgICAgICAgICAgeGhyLm9wZW4oJ1BPU1QnLCAnbWFpbC5waHAnLCB0cnVlKTtcclxuICAgICAgICAgICB4aHIuc2VuZChmb3JtRGF0YSk7XHJcbiAgICAgICBcclxuICAgICAgICAgICBldmVudC50YXJnZXQucmVzZXQoKTtcclxuICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICBmdW5jdGlvbiBzaG93TW9kYWwoKXtcclxuICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1vZGFsXCIpLmNsYXNzTGlzdC5hZGQoXCJvcGVuXCIpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIFxyXG4gICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNsb3NlLW1vZGFsXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1vZGFsXCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xyXG4gICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgIGlmKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibW9kYWxcIikuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwgLm1vZGFsX19ib3hcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgZS5faXNDa2xpY2tXaXRoaW5Nb2RhbCA9IHRydWU7XHJcbiAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtb2RhbFwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+e1xyXG4gICAgICAgICAgIGlmKGUuX2lzQ2tsaWNrV2l0aGluTW9kYWwpIHJldHVybjtcclxuICAgICAgICAgICBlLmN1cnJlbnRUYXJnZXQuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XHJcbiAgICAgICAgIH0pO1xuXG59KSkpO1xuIl19
